---
tags:
  - IMAP
---
# Internet Mail Access Protocol (IMAP)

Allows a client to access and manipulate electronic mail messages on a server. Includes operations for creating, deleting, and renaming mailboxes, checking for new messages, permanently removing messages, setting and clearing flags, parsing, searching, and selective fetching of message attributes, texts, and portions thereof. Messages are accessed by the use of message sequence numbers or unique message identifiers.

## Client sender, Server receiver

The client command begins an operation. Each client command is prefixed with an identifier (typically a short alphanumeric string, e.g. `A0001`, `A0002`, etc.) called a **tag** . A different tag is generated by the client for each command.

If the client sends an incomplete command, the server will send a continuation response for the remainder of the command. The response is prefixed with the `+` token. If the server detects an error, it sends a `BAD` completion response with a tag matching the command.

### Possible server completion result responses

It is tagged with the same tag as the client command which began the operation. `OK` indicates success, `NO` indicates failure, `BAD` indicates a protocol error such as unrecognized command or command syntax error.

## Server sender, Client receiver

Data transmitted by the server to the client (and status responses that do not indicate command completion) are prefixed with the token `*` and are called **untagged** responses.

# Client Commands

## Client Commands - Any State

### `CAPABILITY`

Requests a listing of capabilities that the server supports. The server must send back a single untagged `CAPABILITY` response.

### `NOOP`

The `NOOP` command always succeeds. It does nothing. It can be used as a periodic poll for new messages or message status updates during a period of inactivity.

### `LOGOUT`

Informs the server that the client is done with the connection. The server must send back a `BYE` untagged response before the `OK` response and then close the connection.

## Client Commands - Not Authenticated State

### `STARTTLS`

A TLS negotiation begins immediately after the CRLF at the end of the tagged `OK` response from the server. Once the command is issued, the client must not issue further commands until a server response is seen and the TLS negotiation is complete.

```

   Example:    C: a001 CAPABILITY
               S: * CAPABILITY IMAP4rev1 STARTTLS LOGINDISABLED
               S: a001 OK CAPABILITY completed
               C: a002 STARTTLS
               S: a002 OK Begin TLS negotiation now
               <TLS negotiation, further commands are under [TLS] layer>
```

### `AUTHENTICATE`

Indicates a SASL authentication mechanism to the server. If the server supports the request mechanism, it performs an authentication protocol exchange to authenticate and identify the client.  If the mechanism is unsupported it should reject the command by sending a tagged `NO` response.

```
   Example:    S: * OK IMAP4rev1 Server
               C: A001 AUTHENTICATE GSSAPI
               S: +
               C: YIIB+wYJKoZIhvcSAQICAQBuggHqMIIB5qADAgEFoQMCAQ6iBw
                  MFACAAAACjggEmYYIBIjCCAR6gAwIBBaESGxB1Lndhc2hpbmd0
                  b24uZWR1oi0wK6ADAgEDoSQwIhsEaW1hcBsac2hpdmFtcy5jYW
                  Mud2FzaGluZ3Rvbi5lZHWjgdMwgdCgAwIBAaEDAgEDooHDBIHA
                  cS1GSa5b+fXnPZNmXB9SjL8Ollj2SKyb+3S0iXMljen/jNkpJX
                  AleKTz6BQPzj8duz8EtoOuNfKgweViyn/9B9bccy1uuAE2HI0y
                  C/PHXNNU9ZrBziJ8Lm0tTNc98kUpjXnHZhsMcz5Mx2GR6dGknb
                  I0iaGcRerMUsWOuBmKKKRmVMMdR9T3EZdpqsBd7jZCNMWotjhi
                  vd5zovQlFqQ2Wjc2+y46vKP/iXxWIuQJuDiisyXF0Y8+5GTpAL
                  pHDc1/pIGmMIGjoAMCAQGigZsEgZg2on5mSuxoDHEA1w9bcW9n
                  FdFxDKpdrQhVGVRDIzcCMCTzvUboqb5KjY1NJKJsfjRQiBYBdE
                  NKfzK+g5DlV8nrw81uOcP8NOQCLR5XkoMHC0Dr/80ziQzbNqhx
                  O6652Npft0LQwJvenwDI13YxpwOdMXzkWZN/XrEqOWp6GCgXTB
                  vCyLWLlWnbaUkZdEYbKHBPjd8t/1x5Yg==
               S: + YGgGCSqGSIb3EgECAgIAb1kwV6ADAgEFoQMCAQ+iSzBJoAMC
                  AQGiQgRAtHTEuOP2BXb9sBYFR4SJlDZxmg39IxmRBOhXRKdDA0
                  uHTCOT9Bq3OsUTXUlk0CsFLoa8j+gvGDlgHuqzWHPSQg==
               C:
               S: + YDMGCSqGSIb3EgECAgIBAAD/////6jcyG4GE3KkTzBeBiVHe
                  ceP2CWY0SR0fAQAgAAQEBAQ=
               C: YDMGCSqGSIb3EgECAgIBAAD/////3LQBHXTpFfZgrejpLlLImP
                  wkhbfa2QteAQAgAG1yYwE=
               S: A001 OK GSSAPI authentication successful
```

### `LOGIN`

Identifies the client to the server and carries the plaintext password authenticating this user.
```
   Example:    C: a001 LOGIN SMITH SESAME
               S: a001 OK LOGIN completed
```

## Client Commands - Authenticated State

### `SELECT`

Selects a mailbox so that the messages in the mailbox can be accessed. Before returning `OK` to the client, the server must send the following untagged data to the client:
- `FLAGS`
- `<n> EXISTS`
- `<n> RECENT`
- `OK [UNSEEN <n>]`
- `OK [PERMANENTFLAGS (<list of flags>)]`
- `OK [UIDNEXT <n>]`
- `OK [UIDVALIDITY <n>]`
```

   Example:    C: A142 SELECT INBOX
               S: * 172 EXISTS
               S: * 1 RECENT
               S: * OK [UNSEEN 12] Message 12 is first unseen
               S: * OK [UIDVALIDITY 3857529045] UIDs valid
               S: * OK [UIDNEXT 4392] Predicted next UID
               S: * FLAGS (\Answered \Flagged \Deleted \Seen \Draft)
               S: * OK [PERMANENTFLAGS (\Deleted \Seen \*)] Limited
               S: A142 OK [READ-WRITE] SELECT completed
```
### `SEARCH`
Searches the mailbox for messages that match the given searching criteria. Criteria consist of one or more search keys. The untagged `SEARCH` response from the server contains a listing of message sequence numbers corresponding to those messages that match the searching criteria. Example search keys

- `ALL`
- `BODY <string>`
- `DELETED`
- `DRAFT`
- `FROM <string>`
- `TO <string>`
- `SUBJECT <string>`
- [Click for a full list of search keys...](https://tools.ietf.org/html/rfc3501#section-6.4.4)

```

   Example:    C: A282 SEARCH FLAGGED SINCE 1-Feb-1994 NOT FROM "Smith"
               S: * SEARCH 2 84 882
               S: A282 OK SEARCH completed
               C: A283 SEARCH TEXT "string not in mailbox"
               S: * SEARCH
               S: A283 OK SEARCH completed
               C: A284 SEARCH CHARSET UTF-8 TEXT {6}
               C: XXXXXX
               S: * SEARCH 43
               S: A284 OK SEARCH completed

```

### `EXAMINE`

Identical to `SELECT` and returns the same output; however, the select mailbox is identified as read-only.

### `CREATE`

Creates a mailbox with the given name. An `OK` response is only returned if a new mailbox with that name has been created.
```
   Example:    C: A003 CREATE owatagusiam/
               S: A003 OK CREATE completed
               C: A004 CREATE owatagusiam/blurdybloop
               S: A004 OK CREATE completed
```
### `DELETE`

Permanently removes the mailbox with the given name. A tagged `OK` response is only returned if the mailbox has been deleted. It is an error to attempt to delete `INBOX` or a mailbox name that does not exist.

### `RENAME`

Changes the name of a mailbox.  tagged `OK` response is only returned if the mailbox has been renamed.

### `SUBSCRIBE`

Adds the specified mailbox name to the server's set of "active" or "subscribed" mailboxes as returned by the `LSUB` command. 

### `UNSUBSCRIBE`

Removes the specified mailbox name from the server's set of "active" or "subscribed" mailboxes.

### `LIST`

Returns a subset of names from the complete set of all names available to the client. Zero or more untagged `LIST` replies are returned. Takes in a reference name and a mailbox name (with possible wildcards).

A non-empty reference name argument is the name of a mailbox or a level of mailbox heirarchy that indicates the context in which the mailbox name is interpreted. An empty "" reference name argument indicates that the mailbox name is interpreted as by `SELECT`.

The `*` character is a wildcard that matches zero or more characters at the position. The `%` character is similar to `*` but it does not match a heirarchy delimiter. If these levels of heirarchy are not also selectable mailboxes, they are returned with the `\Noselect` mailbox name attribute.

### `LSUB`

Returns a subset of names from the set of names that the user has declared as being "active" or "subscribed"

[Click for a list of all client commands...](https://tools.ietf.org/html/rfc3501#section-6.1)

