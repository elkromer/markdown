---
tags:
	- SMTP
	- Mail
---

# Simple Mail Transfer Protocol (SMTP)
> The objective is to transfer mail reliably and efficiently.
* The original Simple Mail Transfer Protocol (1982) [RFC 821](https://tools.ietf.org/html/rfc821)
* SMTP Service Extension for Authentication [RFC 4954](https://tools.ietf.org/html/rfc4954)
* Simple Mail Transfer Protocol (2008) [RFC 5321](https://tools.ietf.org/html/rfc5321)

### Background

SMTP is capable of relaying mail across transport service environments. A transport service provides an interprocess communication environment (`IPCE`). Mail is an application of interprocess communication. Mail can be communicated between processes in different `ICPEs` by relaying through a process connected to two or more IPCEs. 

## Overview

At the result of a user mail request, the sender-SMTP establishes a two-way transmission channel to a receiver-SMTP. The receiver-SMTP may be either the ultimate destination or intermediate. SMTP commands are generated by the sender-SMTP and sent to the receiver-SMTP. SMTP replies are sent back to the sender-SMTP.

```
     -------------------------------------------------------------


               +----------+                +----------+
   +------+    |          |                |          |
   | User |<-->|          |      SMTP      |          |
   +------+    |  Sender- |Commands/Replies| Receiver-|
   +------+    |   SMTP   |<-------------->|    SMTP  |    +------+
   | File |<-->|          |    and Mail    |          |<-->| File |
   |System|    |          |                |          |    |System|
   +------+    +----------+                +----------+    +------+


                Sender-SMTP                Receiver-SMTP

                           Model for SMTP Use

                                Figure 1

     -------------------------------------------------------------
```
There are three steps to SMTP mail transactions:
1. `MAIL` gives the sender identification
2. A series of `RCPT` commands
3. A `DATA` command.


Once the transmission channel is established, the SMTP-sender sends a `MAIL` command indicating the sender of the mail. If SMTP-receiver can accept mail, it responds with `OK`. The SMTP-sender then sends a RCPT command to identify the recipient. If the SMTP-receiver can accept mail for that recipient it responds with OK. Once the recipients have been negotiated,the SMTP-sender sends the mail data, terminating with a special sequence.

**Example procedure**
```
            S: MAIL FROM:<Smith@Alpha.ARPA>
            R: 250 OK

            S: RCPT TO:<Jones@Beta.ARPA>
            R: 250 OK

            S: RCPT TO:<Green@Beta.ARPA>
            R: 550 No such user here

            S: RCPT TO:<Brown@Beta.ARPA>
            R: 250 OK

            S: DATA
            R: 354 Start mail input; end with <CRLF>.<CRLF>
            S: Blah blah blah...
            S: ...etc. etc. etc.
            S: <CRLF>.<CRLF>
            R: 250 OK
```